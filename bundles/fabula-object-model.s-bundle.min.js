!function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}return"function"==typeof window.CustomEvent?!1:(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}(),function(){r(1);var t=r(2);t.globalize=function(){for(var t=Object.getOwnPropertyNames(this.prototype),e=0;e<t.length;e++)window[t[e]]=this.prototype[t[e]]},window.FabulaObjectModel=t}()},function(t,e){!function(){"undefined"!=typeof Promise&&"undefined"==typeof Promise.cascade&&(Promise.cascade=function(t,e){"object"==typeof e&&"functions"!=typeof e.join||(e=Object.create(null));var r="undefined"==typeof e.interval?0:isNaN(e.interval)?0:parseInt(e.interval),n="undefined"==typeof e.stackSize?1:isNaN(e.stackSize)?1:parseInt(e.stackSize),o=[];for(var s in t)t.hasOwnProperty(s)&&o.push(t[s]);t=o;var i=function(e,o){var s,a=[],f=[];for(s=0;s<t.length;s++)null!==t[s]&&f.push(t[s]);for(t=f,s=0;s<t.length&&("function"==typeof t[s]&&a.push(new Promise(t[s])),t[s]=null,!(a.length>=n||t.length==s+1));s++);t.length||e(),Promise.all(a).then(function(){setTimeout(function(){i(e,o)},r)})["catch"](function(t){o(t)})};return new Promise(i)})}()},function(t,e,r){var n=function(t){this._dbInstance=null,this.instances.push(this)};n.prototype={},n.prototype.mod=Object.create(null),n.prototype._lowMethods=Object.create(null),n.prototype._setModule=function(t,e){if("string"!=typeof t)throw new Error("1st argument suppose to be String");t=t.trim(),this.mod[t]=e,this._lowMethods[t.toLowerCase()]=e},n.prototype._setModule("DefaultDataModel",r(3)),n.prototype._setModule("GandsDataModel",r(4)),n.prototype._setModule("InterfaceEvents",r(8)),n.prototype._setModule("CalcDefaultPrint",r(5)),n.prototype._setModule("utils",r(6)),n.prototype._setModule("ObjectA",r(7)),n.prototype.create=function(t,e){if("string"!=typeof t)throw new Error("1st argument suppose to be String");if(t=t.toLowerCase().trim(),"undefined"==typeof this._lowMethods[t])throw new Error('Class "'+t+'" does not exist');var r,n=this._lowMethods[t],o=this.mod.utils.getType(n);return"object"==o?r=n:"function"==o&&(r="function"==typeof n.prototype.getInstance?n.prototype.getInstance():new n),r&&(r._fabulaInstance=this),r},n.prototype.getDBInstance=function(){return this._dbInstance},n.prototype.instances=[],n.prototype.getInstance=function(t){return this.instances.length?this.instances[0]:new n(t)},t.exports=n},function(t,e,r){var n=r(8),o=function(){var t,e,r;if(!(arguments.length<2)){var n=arguments[0];for(e=1;e<arguments.length;e++)if("object"==typeof arguments[e]){t={};for(r in arguments[e])arguments[e].hasOwnProperty(r)&&(t[r]={writable:!0,configurable:!0,enumerable:!0,value:arguments[e][r]});n=Object.create(n,t)}return n}},s=function(){this.props=Object.create(null),this.aliases=Object.create(null),this.aliases.get=Object.create(null),this.aliases.getMethods=Object.create(null),this.aliases.set=Object.create(null),this.aliases.setMethods=Object.create(null),this.propsChanged=Object.create(null),this._DataModelSettings={caseSensitiveProps:!1},n.call(this),this.on("set",this._defaultEventSet),this.on("get",this._defaultEventGet),this.clearChanged()};s.prototype=o(n.prototype,{_objectsPrototyping:o,_defaultEventSet:function(t,e){this.trigger(e.type,e)},_defaultEventGet:function(t,e){this.trigger(e.type,e)},setAlias:function(t,e,r){"string"==typeof t&&"string"==typeof e&&(this._DataModelSettings.caseSensitiveProps||(e=e.toLowerCase(),"string"==typeof r&&(r=r.toLowerCase())),"get"==t?this.aliases.get[r]=e:"getMethod"==t&&"function"==typeof r?this.aliases.getMethods[e]=r:"set"==t?this.aliases.set[r]=e:"setMethod"==t&&"function"==typeof r&&(this.aliases.setMethods[e]=r))},get:function(t,e,r){if("string"==typeof t){if(this._DataModelSettings.caseSensitiveProps||(t=t.toLowerCase()),"string"==typeof this.aliases.get[t]&&(t=this.aliases.get[t]),"undefined"==typeof r&&(r=!0),r&&this.trigger("get:"+t),"undefined"!=typeof this.aliases.getMethods[t]){if("undefined"==typeof e&&(e=Object.create(null)),"string"==typeof this.aliases.getMethods[t]){if(t=this.aliases.getMethods[t],"function"!=typeof this[t])return;return this[t].apply(this,[e])}return"function"==typeof this.aliases.getMethods[t]?this.aliases.getMethods[t].apply(this,[e]):void 0}return"undefined"!=typeof this.props[t]?this.props[t]:void 0}},set:function(t,e,r,n){if("undefined"==typeof t)return!1;if("object"==typeof t){var o=Object.create(null);for(var s in t)t.hasOwnProperty(s)&&(o[s]=this.set(s,t[s]));return o}if("string"!=typeof t)return!1;if(this._DataModelSettings.caseSensitiveProps||(t=t.toLowerCase()),"string"==typeof this.aliases.set[t]&&(t=this.aliases.set[t]),"undefined"==typeof n&&(n=!0),n){var i=this._createEvent("set:"+t,{value:e,argument:r}),a=this._createEvent("afterset:"+t,{value:e,argument:r});this.trigger(i.type,i)}var f=!0;if("undefined"!=typeof this.aliases.setMethods[t])if("undefined"==typeof r&&(r=Object.create(null)),"string"==typeof this.aliases.setMethods[t]){var p=this.aliases.setMethods[t];if("function"!=typeof this[p])return!1;this.propsChanged[t]=!0,f=this[p].apply(this,[e,r])}else{if("function"!=typeof this.aliases.setMethods[t])return!1;this.propsChanged[t]=!0,f=this.aliases.setMethods[t].apply(this,[e,r])}else this.propsChanged[t]=!0,this.props[t]=e;return n&&this.trigger(a.type,a),f||!0},getChanged:function(){var t=[];for(var e in this.propsChanged)("function"!=typeof this.propsChanged.hasOwnProperty||this.propsChanged.hasOwnProperty(e))&&t.push(e);return t},clearChanged:function(){this.propsChanged=Object.create(null)}}),t.exports=s},function(t,e,r){var n=function(){var t=r(2),e=t.prototype.DBModel;return this._fabulaInstance?this._fabulaInstance.getDBInstance():e.prototype.getInstance()},o=function(){this.init()};o.prototype={init:function(){this.dbModel=null,this.data=[],this.instances.push(this),this.GSUnits=Object.create(null),this.state=0},instances:[],getInstance:function(){return this.instances.length?this.instances[0]:new o},load:function(t){"undefined"==typeof t&&(t=Object.create(null));var e="function"==typeof t.callback?t.callback:function(){},r=n.call(this),o=this,s=["SELECT * FROM Gands WHERE GSCOP LIKE '87%' OR GSCOP LIKE '17%' OR GSCOP LIKE '27%' OR GSCOP LIKE '07%' ","SELECT * FROM GandsExt WHERE GSExID IN (SELECT GSID FROM Gands WHERE GSCOP LIKE '87%' OR GSCOP LIKE '17%' OR GSCOP LIKE '27%' OR GSCOP LIKE '07%')"];r&&r.dbquery({query:s.join("; "),callback:function(t){o.data=t[0].recs,o.state=1;var r,n,s=Object.create(null);for(r=0;r<o.data.length;r++)s[o.data[r].GSID]=o.data[r],o.data[r].gandsExtRef=[];o.dataReferences=s;var i=t[1].recs;for(r=0;r<i.length;r++)"undefined"!=typeof s[i[r].GSExID]&&s[i[r].GSExID].gandsExtRef.push(i[r]);for(r=0,n=o.data.length;n>r;r++)"undefined"==typeof o.GSUnits[o.data[r].GSID]&&(o.GSUnits[o.data[r].GSID]=o.data[r].GSUnit);e(o.data)}})},get:function(t){"object"!=typeof t&&(t=Object.create(null));var e="object"!=typeof t.type?[]:t.type,r="object"!=typeof t.cop?[]:t.cop;if(!e.length&&!r.length)return this.data;var n,o,s=[];for(n=0;n<this.data.length;n++)if(!(s.indexOf(this.data[n])>-1)){if(e.indexOf("material-paper")>-1&&this.data[n].GSID.toLowerCase().match(/тцбу/gi)&&this.data[n].GSID.length>4&&s.push(this.data[n]),e.indexOf("paper")>-1&&this.data[n].GSID.toLowerCase().match(/тцбуме|тцбуоф|тцбуса|тцбуск|тцбуцп|тцбуфб/gi)&&s.push(this.data[n]),e.indexOf("materials:print")>-1&&this.data[n].GSID.match(/тцмп/gi)){if(this.data[n].GSID.match(/тцмпбг|тцмпкк|тцмпкл|тцмпкр|тцмпкт|тцмпрс|тцмпс1|тцмпск|тцмпто/gi)||this.data[n].GSID.length<=6)continue;s.push(this.data[n])}for(e.indexOf("carton")>-1&&this.data[n].GSID.toLowerCase().match(/тцбуд1|тцбуд3|тцбукр|тцбупр/gi)&&s.push(this.data[n]),e.indexOf("envelope")>-1&&this.data[n].GSID.toLowerCase().match(/тцбуко/)&&s.push(this.data[n]),e.indexOf("products")>-1&&(this.data[n].GSCOP.match(/17/)||this.data[n].GSCOP.match(/27/))&&(this.data[n].GSCOP.match(/276|176/)||s.push(this.data[n])),e.indexOf("print")>-1&&(this.data[n].GSCOP.match(/17/)||this.data[n].GSCOP.match(/27/)||this.data[n].GSCOP.match(/07/))&&s.push(this.data[n]),e.indexOf("products:print")>-1&&(this.data[n].GSCOP.match(/17/)||this.data[n].GSCOP.match(/27/))&&(this.data[n].GSCOP.match(/276|176/)||s.push(this.data[n])),o=0;o<r.length;o++)r[o]instanceof RegExp?this.data[n].GSCOP.match(r[o])&&s.push(this.data[n]):"string"==typeof r[o].GSCOP&&r[o]==this.data[n]&&s.push(this.data[n])}return s},getGSUnit:function(t){return"undefined"!=typeof t&&"undefined"!=typeof this.GSUnits[t]?this.GSUnits[t]:void 0}},t.exports=o},function(t,e,r){var n=r(4),o=function(){this.instances.push(this)};o.prototype.instances=[],o.prototype.getInstance=function(){return this.instances.length?this.instances[0]:new o},o.prototype.calc=function(t){if("object"!=typeof t)throw new Error("1st argument suppose to be Object");if("undefined"==typeof t.amount||isNaN(t.amount))throw new Error("arg.amount suppose to be Numeric");var e=+t.amount;if("string"!=typeof t.GSID||!t.GSID)throw new Error("arg.GSID suppose to be String");var r=t.GSID,o=!0;"undefined"!=typeof t.salePrice&&(o=Boolean(t.salePrice));var s=n.prototype.getInstance();if(!s.dataReferences.has(r))return 0;var i=s.dataReferences.get(r),a={price:o?i.GSCostSale:i.GSCost,gsCost:i.GSCost,gsCostSale:i.GSCostSale};a.sum=a.price*e;var f,p,h=0,u=0;i.gandsExtRef.sort(function(t,e){return t.GSExSort-e.GSExSort});for(var c=0;c<i.gandsExtRef.length;c++)if(f=+i.gandsExtRef[c].GSExNum,p=+i.gandsExtRef[c].GSExSort,(o||"цена продажи"!=i.gandsExtRef[c].GSExType.toLowerCase().trim())&&(!o||"цена продажи"==i.gandsExtRef[c].GSExType.toLowerCase().trim()))if(e>=p)h=f,u=p;else if(p>=e){try{0==h?h=f/(p||1)*e:h+=(f-h)*(e-u)/(p-u),u=e}catch(l){console.error(l)}break}var d={price:a.price,sum:a.sum};return h&&(d.sum=h,d.price=h/(e>u?u:e)||1),d},t.exports=o},function(t,e){var r=Object.create(null);r.DBSecureStr=function(t){if(arguments.length){if("string"!=typeof t)return t;for(var e=[[new RegExp(/["']/g),""],["№","N"]],r=0;r<e.length;r++)t=t.replace(e[r][0],e[r][1]);return t}},r.msplit=function(t,e){if("string"==typeof t)t=[t];else if(!Array.isArray(t))throw new Error('First argument suppose to be "Array" or "String"');if("string"!=typeof e)throw new Error('Second argument suppose to be "String"');var r=new RegExp("["+t.join("")+"]","g");return e=e.replace(r,t[0]),e.split(t[0])},r.split=function(t,e){this.msplit.apply(this,arguments)},r.trim=function(t,e,r){if("string"!=typeof t)throw new Error("1st argument suppose to be String");if("string"==typeof e)e=e.split("");else if(!Array.isArray(e))throw new Error("1st argument suppose to be String or Array");for("number"!=typeof r&&(r=-1),t=t.split("");t.length;)if((-1===r||0===r)&&e.indexOf(t[0])>-1)t.shift();else{if(-1!==r&&1!==r||!(e.indexOf(t[t.length-1])>-1))break;t.pop()}return t.join("")},r.ltrim=function(t,e){var r=Array.prototype.slice.call(arguments,0);return r[2]=0,this.trim.apply(this,r)},r.rtrim=function(t,e){var r=Array.prototype.slice.call(arguments,0);return r[2]=1,this.trim.apply(this,r)},r.arrayRemove=function(t,e,r){var n=t.slice((r||e)+1||t.length);return t.length=0>e?t.length+e:e,t.push.apply(t,n)},r.arrayRest=function(t,e){if("object"!=typeof t)throw new Error("1st argument suppose to be Array");if("number"!=typeof e)throw new Error("2nd argument suppose to be Number");return Array.prototype.slice.call(t,Math.abs(e))},r.objectHasOwnProperty=function(t,e){if(arguments.length<2)return!1;if("object"!=typeof t)return!1;for(var r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++)if(r[n]==e)return!0;return!1},r.objectKeysToLowerCase=function(t){if("object"!=typeof t)return null;for(var e=Object.getOwnPropertyNames(t),r={},n=0;n<e.length;n++)r[e[n].toLowerCase()]=t[e[n]];return r},r.objectKeysToUpperCase=function(t){if("object"!=typeof t)return null;for(var e=Object.getOwnPropertyNames(t),r={},n=0;n<e.length;n++)r[e[n].toUpperCase()]=t[e[n]];return r},r.URLHashParse=function(){var t={};if(location.hash){var e=location.hash.replace("#","");e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].match(/=/g);if(n&&1==n.length){var o=e[r].split("=");t[o[0]]=o[1]}}}return t},r.URLHashSet=function(t){var e,r=this,n="undefined"==typeof t.newHash?!1:t.newHash,o=n?Object.create(null):r.URLHashParse();for(e in t.vars)t.vars.hasOwnProperty(e)&&(null===t.vars[e]?delete o[e]:o[e]=t.vars[e]);var s=[];for(e in o)o.hasOwnProperty(e)&&s.push(e+"="+o[e]);s="#"+s.join("&"),location.hash=s},r.URLQueryParse=function(){var t={};if(location.search){var e=location.search.replace(/^[?]/,"");e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].match(/=/g);if(n&&1==n.length){var o=e[r].split("=");t[o[0]]=o[1]}}}return t},r.URLQuerySet=function(t){var e,r="undefined"==typeof t.newQuery?!1:t.newQuery,n=r?Object.create(null):this.URLQueryParse();for(e in t.vars)t.vars.hasOwnProperty(e)&&(null===t.vars[e]?delete n[e]:n[e]=t.vars[e]);var o=[];for(e in n)n.hasOwnProperty(e)&&o.push(e+"="+n[e]);o="?"+o.join("&"),location.search=o},r.awwsBase64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){if(!t)return"";var e,r,n,o,s,i,a,f="",p=0;for(t=this._utf8_encode(t);p<t.length;)e=t.charCodeAt(p++),r=t.charCodeAt(p++),n=t.charCodeAt(p++),o=e>>2,s=(3&e)<<4|r>>4,i=(15&r)<<2|n>>6,a=63&n,isNaN(r)?i=a=64:isNaN(n)&&(a=64),f=f+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(i)+this._keyStr.charAt(a);return f=(f.length>5?f.substr(5,1):"x")+f},decode:function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(!t)return"";t=t.substr(1);var r,n,o,s,i,a,f,p="",h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)s=e.indexOf(t.charAt(h++)),i=e.indexOf(t.charAt(h++)),a=e.indexOf(t.charAt(h++)),f=e.indexOf(t.charAt(h++)),r=s<<2|i>>4,n=(15&i)<<4|a>>2,o=(3&a)<<6|f,p+=String.fromCharCode(r),64!=a&&(p+=String.fromCharCode(n)),64!=f&&(p+=String.fromCharCode(o));return p=this._utf8_decode(p)},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},_utf8_decode:function(t){for(var e="",r=0,n=0,o=0,s=0;r<t.length;)n=t.charCodeAt(r),128>n?(e+=String.fromCharCode(n),r++):n>191&&224>n?(o=t.charCodeAt(r+1),e+=String.fromCharCode((31&n)<<6|63&o),r+=2):(o=t.charCodeAt(r+1),s=t.charCodeAt(r+2),e+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&s),r+=3);return e}},r.getType=function(t){return"[object Array]"==toString.call(t)?"array":"[object Object]"==toString.call(t)?"object":null===t?"null":"[object Date]"==t?"date":typeof t},r.parseArg=function(t){var e="string"==typeof t.into?t.into.toLowerCase():"array",r="undefined"!=typeof t.value?t.value:null,n="boolean"==typeof t.kickEmpty?t.kickEmpty:!0,o="boolean"==typeof t.toLowerCase?t.toLowerCase:!1,s="boolean"==typeof t.toUpperCase?t.toUpperCase:!1,i="boolean"==typeof t.toInt?t.toInt:!1,a="boolean"==typeof t.toFloat?t.toFloat:!1,f="boolean"==typeof t.isInt?t.isInt:!1,p="boolean"==typeof t.isFloat?t.isFloat:!1,h=Array.isArray(t.delimiters)&&t.delimiters.length?t.delimiters:[";",","],u="undefined"==typeof t.trim?[" "]:Array.isArray(t.trim)?t.trim:"string"==typeof t.trim?t.split(""):null;if(null===r)return null;if("array"==e){if(Array.isArray(r));else if("string"==typeof r)r=this.msplit(h,r);else{if(isNaN(r))return null;r=[r]}for(var c=[],l=0;l<r.length;l++){var d=r[l];if(null!==u&&"string"==typeof d&&(d=this.trim(d,u)),!n||""!==d&&null!==d){if(o&&"string"==typeof d&&(d=d.toLowerCase()),s&&"string"==typeof d&&(d=d.toUpperCase()),f||p)if("string"!=typeof d||isNaN(d)){if(f&&d-Math.floor(d)>0)continue;if(p&&d-Math.floor(d)==0)continue}else if(d=d.trim(),p){if(d=d.replace(",","."),!d.match("/[.]/"))continue}else if(f&&(d=d.replace(",","."),d.match("/[.]/")))continue;i&&(d=parseInt(d)),a&&(d=parseFloat(d)),c.push(d)}}return c}},t.exports=r},function(t,e){var r=function(t){if(this instanceof r==!1)throw new Error("Wrong context");if(this._props=Object.create(null),arguments.length){if("object"!=typeof t)throw new Error('Argument suppose to be type "Object"');for(var e=Object.getOwnPropertyNames(t),n=0;n<e.length;n++)this.set(e[n],t[e[n]])}};r.create=function(t){return new r(t)},r.prototype={getKeys:function(){return Object.getOwnPropertyNames(this._props)},getLength:function(){return this.getKeys().length},get:function(t){if("string"!=typeof t)throw new Error('Argument suppose to be type "String"');return t=t.toLowerCase(),this.has(t)?this._props[t]:void 0},set:function(t,e){if(arguments.length<2)throw new Error("Suppose to be 2 arguments");if("string"!=typeof t)throw new Error('Argument suppose to be type "String"');this._props[t.toLowerCase()]=e},has:function(t){if("string"!=typeof t)throw new Error('Argument suppose to be type "String"');return Boolean(Object.getOwnPropertyDescriptor(this._props,t.toLowerCase()))},remove:function(t){if("string"!=typeof t)throw new Error('Argument suppose to be type "String"');delete this._props[t.toLowerCase()]}},t.exports=r},function(t,e,r){var n=r(9);if("undefined"==typeof o)var o=n;if("undefined"==typeof s)var s=n;var i=function(){this._events={}};i.prototype={trigger:function(t,e){if("string"!=typeof t)return!1;if(t=t.toLowerCase(),"object"==typeof this._events[t]&&Array.isArray(this._events[t])){e instanceof n&&e instanceof o==!1&&e instanceof s==!1&&(e=this._createEvent(t));for(var r=this._events[t],i=0;i<r.length;i++)if("function"==typeof r[i]){var a=r[i];r[i].isOnce&&this._removeListener(t,r[i]._unique_id),a.apply(this,[this,e]),a=null}}},on:function(t,e){return"string"!=typeof t||"function"!=typeof e?!1:(t=t.toLowerCase(),"object"==typeof this._events[t]&&Array.isArray(this._events[t])||(this._events[t]=[]),e._unique_id=Math.round(Math.random()*Math.pow(10,18)),"undefined"==typeof e.isOnce&&(e.isOnce=!1),this._events[t].push(e),!0)},_removeListener:function(t,e){if("undefined"==typeof e)return void(this._events[t]=[]);if("object"==typeof this._events[t]&&Array.isArray(this._events[t])){for(var r=[],n=this._events[t],o=0;o<n.length;o++)n[o]._unique_id!=e&&r.push(n[o]);this._events[t]=r}},_createEvent:function(t,e){if("object"!=typeof document)return new n(t);var r=o||s,i=new r(t);if("object"==typeof e)for(var a in e)e.hasOwnProperty&&!e.hasOwnProperty(a)||(i[a]=e[a]);return i},getListeners:function(t){return"string"!=typeof t?[]:"object"!=typeof this._events[t]?[]:this._events[t]},once:function(t,e){return"function"!=typeof e||"string"!=typeof t?!1:(e.isOnce=!0,this.on(t,e),!0)}},t.exports=i},function(t,e){var r=function(t){if("string"!=typeof t)throw new Error("1st argument suppose to be String");this.type=t,this.timestamp=Date.now(),this.currentTarget=null,this.cancelable=!1,this.detail=null,this.eventPhase=null,this.target=null};t.exports=r}]);